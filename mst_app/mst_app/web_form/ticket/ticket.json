{
 "allow_comments": 0,
 "allow_delete": 0,
 "allow_edit": 0,
 "allow_incomplete": 0,
 "allow_multiple": 0,
 "allow_print": 0,
 "anonymous": 0,
 "apply_document_permissions": 0,
 "button_label": "Create",
 "client_script": "frappe.web_form.after_load = () => {\n    console.log(\"after_load\");\n};\n\nfrappe.web_form.on('sla_number', (field, value) => {\n            console.log(value);\n            if (value != null && value != '' && value != ' '){\n                frappe.call({\n    \t\t\tmethod: \"mst_app.ticket_form.check_sla\",\n    \t\t\targs: {\n    \t\t\t     sla_number: frappe.web_form.doc.sla_number,\n    \t\t\t},\n    \t\t\tcallback: r => {\n    \t\t\t\tif (!r.exc && r.message){\n    \t\t\t\t\tconsole.log(r.message);\n    \t\t\t\t\tfrappe.web_form.set_value(\"customer_name\", r.message)\n                    }\n                    else{\n                        console.error('SLA Number');\n                        frappe.msgprint(\"SLA Number is incorrect\");\n                    }\n                }\n            })\n        }\n    });\n\nfrappe.web_form.validate = () => {\n    console.log(\"saving....\");\n    \n    // validate email.\n        let email = frappe.web_form.doc.email ;\n        if (email.includes('@') && email.includes('.') && !email.includes(' ')) {} \n        else {\n            console.error('Invalid email address');\n            return false;\n        }\n\n    // Date validation.\n        let start_d = new Date(frappe.web_form.doc.start_date);\n        let end_d = new Date(frappe.web_form.doc.end_date);\n        \n        if (end_d <= start_d) {\n            console.error('End date must be after start date');\n            return false;\n        }\n    \n    // serial_number and product_number validation.\n        let topic = frappe.web_form.doc.topic;\n        let serial_number = frappe.web_form.doc.serial_number;\n        let product_number = frappe.web_form.doc.product_number;\n        \n        if (topic == 'HPE Systems' || topic == 'VMware' ){\n            if(serial_number == null || product_number == null){\n                console.error('serial number and product number');\n                return false;\n            }\n        }\n    \n    \n    \n    // SLA Number validation.\n        let existing_customer = frappe.web_form.doc.existing_customer;\n        let sla_number = frappe.web_form.doc.sla_number;\n        \n        if (existing_customer == 1 && sla_number == null){\n            console.error('customer number');\n        }\n        \n        \n    //send email after submit.\n        frappe.call({\n        \t\t\tmethod: \"mst_app.ticket_form.send_email_to_customer\",\n        \t\t\targs: {\n        \t\t\t    email: frappe.web_form.doc.email,\n        \t\t\t    customer_name: frappe.web_form.doc.customer_name,\n        \t\t\t    topic: frappe.web_form.doc.topic,\n        \t\t\t    issue: frappe.web_form.doc.issue,\n        \t\t\t    start_date: frappe.web_form.doc.start_date,\n        \t\t\t    end_date: frappe.web_form.doc.end_date,\n        \t\t\t    on_site: frappe.web_form.doc.on_site,\n        \t\t\t},\n        \t\t\t\n        \t\t\tcallback: r => {\n        \t\t\t\tif (!r.exc && r.message){\n        \t\t\t\t\tconsole.log(r.message);\n                        }\n                    }\n            });\n            \n       \n    // If all validations pass, return true.\n        return true;\n\n};\n\n",
 "condition_json": "[]",
 "creation": "2024-07-29 15:06:53.497277",
 "custom_css": "h1{\n    color:#00AEEF;\n}",
 "doc_type": "Ticket",
 "docstatus": 0,
 "doctype": "Web Form",
 "idx": 0,
 "introduction_text": "<div class=\"ql-editor read-mode\"><p>Please fill in the form below to open a new ticket.</p></div>",
 "is_standard": 1,
 "list_columns": [],
 "login_required": 0,
 "max_attachment_size": 0,
 "meta_image": "",
 "modified": "2024-08-05 16:06:34.899419",
 "modified_by": "Administrator",
 "module": "Mst App",
 "name": "ticket",
 "owner": "Administrator",
 "published": 1,
 "route": "ticket",
 "show_attachments": 0,
 "show_list": 0,
 "show_sidebar": 0,
 "success_message": "You will receive an email with the ticket details.",
 "success_title": "Thank you,",
 "title": "Ticket",
 "web_form_fields": [
  {
   "allow_read_on_all_link_options": 0,
   "default": "0",
   "fieldname": "existing_customer",
   "fieldtype": "Check",
   "hidden": 0,
   "label": "Existing Customer",
   "max_length": 0,
   "max_value": 0,
   "precision": "",
   "read_only": 0,
   "reqd": 0,
   "show_in_filter": 0
  },
  {
   "allow_read_on_all_link_options": 0,
   "depends_on": "eval:doc.existing_customer == 1",
   "fieldname": "sla_number",
   "fieldtype": "Data",
   "hidden": 0,
   "label": "SLA Number",
   "max_length": 0,
   "max_value": 0,
   "options": "",
   "precision": "",
   "read_only": 0,
   "reqd": 0,
   "show_in_filter": 0
  },
  {
   "allow_read_on_all_link_options": 0,
   "fieldname": "column_break_sh88",
   "fieldtype": "Column Break",
   "hidden": 0,
   "max_length": 0,
   "max_value": 0,
   "precision": "",
   "read_only": 0,
   "reqd": 0,
   "show_in_filter": 0
  },
  {
   "allow_read_on_all_link_options": 0,
   "fieldname": "section_break_customer_info",
   "fieldtype": "Section Break",
   "hidden": 0,
   "max_length": 0,
   "max_value": 0,
   "precision": "",
   "read_only": 0,
   "reqd": 0,
   "show_in_filter": 0
  },
  {
   "allow_read_on_all_link_options": 0,
   "fieldname": "customer_name",
   "fieldtype": "Data",
   "hidden": 0,
   "label": "Customer Name",
   "max_length": 0,
   "max_value": 0,
   "precision": "",
   "read_only": 0,
   "reqd": 1,
   "show_in_filter": 0
  },
  {
   "allow_read_on_all_link_options": 0,
   "depends_on": "customer_name",
   "fieldname": "company_name",
   "fieldtype": "Data",
   "hidden": 0,
   "label": "Company Name",
   "max_length": 0,
   "max_value": 0,
   "precision": "",
   "read_only": 0,
   "reqd": 1,
   "show_in_filter": 0
  },
  {
   "allow_read_on_all_link_options": 0,
   "depends_on": "company_name",
   "fieldname": "company_location",
   "fieldtype": "Data",
   "hidden": 0,
   "label": "Company Location",
   "max_length": 0,
   "max_value": 0,
   "precision": "",
   "read_only": 0,
   "reqd": 0,
   "show_in_filter": 0
  },
  {
   "allow_read_on_all_link_options": 0,
   "fieldname": "column_break_sh88",
   "fieldtype": "Column Break",
   "hidden": 0,
   "max_length": 0,
   "max_value": 0,
   "precision": "",
   "read_only": 0,
   "reqd": 0,
   "show_in_filter": 0
  },
  {
   "allow_read_on_all_link_options": 0,
   "depends_on": "customer_name",
   "fieldname": "email",
   "fieldtype": "Data",
   "hidden": 0,
   "label": "Email",
   "max_length": 0,
   "max_value": 0,
   "precision": "",
   "read_only": 0,
   "reqd": 1,
   "show_in_filter": 0
  },
  {
   "allow_read_on_all_link_options": 0,
   "depends_on": "customer_name",
   "fieldname": "phone",
   "fieldtype": "Phone",
   "hidden": 0,
   "label": "Phone",
   "max_length": 0,
   "max_value": 0,
   "precision": "",
   "read_only": 0,
   "reqd": 1,
   "show_in_filter": 0
  },
  {
   "allow_read_on_all_link_options": 0,
   "depends_on": "customer_name",
   "fieldname": "section_break_topic",
   "fieldtype": "Section Break",
   "hidden": 0,
   "label": "Ticket Details",
   "max_length": 0,
   "max_value": 0,
   "precision": "",
   "read_only": 0,
   "reqd": 0,
   "show_in_filter": 0
  },
  {
   "allow_read_on_all_link_options": 0,
   "depends_on": "",
   "fieldname": "topic",
   "fieldtype": "Select",
   "hidden": 0,
   "label": "Topic",
   "max_length": 0,
   "max_value": 0,
   "options": "\nFeedback\nGeneral Technical Support\nNetworking Problem\nHardware failure\nSoftware Problem\nSystem Problem\nHPE Systems\nVMware",
   "precision": "",
   "read_only": 0,
   "reqd": 1,
   "show_in_filter": 0
  },
  {
   "allow_read_on_all_link_options": 0,
   "depends_on": "topic",
   "fieldname": "section_break_issue",
   "fieldtype": "Section Break",
   "hidden": 0,
   "label": "",
   "max_length": 0,
   "max_value": 0,
   "precision": "",
   "read_only": 0,
   "reqd": 0,
   "show_in_filter": 0
  },
  {
   "allow_read_on_all_link_options": 0,
   "fieldname": "issue",
   "fieldtype": "Data",
   "hidden": 0,
   "label": "Issue",
   "max_length": 0,
   "max_value": 0,
   "precision": "",
   "read_only": 0,
   "reqd": 1,
   "show_in_filter": 0
  },
  {
   "allow_read_on_all_link_options": 0,
   "depends_on": "issue",
   "fieldname": "issue_summary",
   "fieldtype": "Small Text",
   "hidden": 0,
   "label": "Issue Summary",
   "max_length": 0,
   "max_value": 0,
   "precision": "",
   "read_only": 0,
   "reqd": 0,
   "show_in_filter": 0
  },
  {
   "allow_read_on_all_link_options": 0,
   "depends_on": "issue",
   "fieldname": "attachment",
   "fieldtype": "Attach",
   "hidden": 0,
   "label": "Attachment",
   "max_length": 0,
   "max_value": 0,
   "precision": "",
   "read_only": 0,
   "reqd": 0,
   "show_in_filter": 0
  },
  {
   "allow_read_on_all_link_options": 0,
   "depends_on": "issue",
   "fieldname": "priority",
   "fieldtype": "Select",
   "hidden": 0,
   "label": "Priority",
   "max_length": 0,
   "max_value": 0,
   "options": "\nLow\nMedium\nHigh",
   "precision": "",
   "read_only": 0,
   "reqd": 1,
   "show_in_filter": 0
  },
  {
   "allow_read_on_all_link_options": 0,
   "depends_on": "priority",
   "fieldname": "section_break_guf6",
   "fieldtype": "Section Break",
   "hidden": 0,
   "max_length": 0,
   "max_value": 0,
   "precision": "",
   "read_only": 0,
   "reqd": 0,
   "show_in_filter": 0
  },
  {
   "allow_read_on_all_link_options": 0,
   "default": "0",
   "depends_on": "eval:doc.existing_customer == 0",
   "fieldname": "payment_accept",
   "fieldtype": "Check",
   "hidden": 0,
   "label": "Payment Accept",
   "max_length": 0,
   "max_value": 0,
   "precision": "",
   "read_only": 0,
   "reqd": 0,
   "show_in_filter": 0
  },
  {
   "allow_read_on_all_link_options": 0,
   "fieldname": "start_date",
   "fieldtype": "Date",
   "hidden": 0,
   "label": "Start Date",
   "max_length": 0,
   "max_value": 0,
   "precision": "",
   "read_only": 0,
   "reqd": 1,
   "show_in_filter": 0
  },
  {
   "allow_read_on_all_link_options": 0,
   "fieldname": "end_date",
   "fieldtype": "Date",
   "hidden": 0,
   "label": "End Date",
   "max_length": 0,
   "max_value": 0,
   "precision": "",
   "read_only": 0,
   "reqd": 1,
   "show_in_filter": 0
  },
  {
   "allow_read_on_all_link_options": 0,
   "fieldname": "on_site",
   "fieldtype": "Select",
   "hidden": 0,
   "label": "On Site",
   "max_length": 0,
   "max_value": 0,
   "options": "\non site\nRemotely",
   "precision": "",
   "read_only": 0,
   "reqd": 1,
   "show_in_filter": 0
  },
  {
   "allow_read_on_all_link_options": 0,
   "depends_on": "eval:doc.topic == 'HPE Systems' ||  doc.topic == 'VMware'",
   "fieldname": "section_break_hpe",
   "fieldtype": "Section Break",
   "hidden": 0,
   "label": "HPE/VMware",
   "max_length": 0,
   "max_value": 0,
   "precision": "",
   "read_only": 0,
   "reqd": 0,
   "show_in_filter": 0
  },
  {
   "allow_read_on_all_link_options": 0,
   "fieldname": "serial_number",
   "fieldtype": "Data",
   "hidden": 0,
   "label": "Serial Number",
   "max_length": 0,
   "max_value": 0,
   "precision": "",
   "read_only": 0,
   "reqd": 0,
   "show_in_filter": 0
  },
  {
   "allow_read_on_all_link_options": 0,
   "fieldname": "product_number",
   "fieldtype": "Data",
   "hidden": 0,
   "label": "Product Number",
   "max_length": 0,
   "max_value": 0,
   "precision": "",
   "read_only": 0,
   "reqd": 0,
   "show_in_filter": 0
  }
 ]
}